<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: James Bush | IndyRB.org]]></title>
  <link href="http://indyrb.github.io/blog/categories/james-bush/atom.xml" rel="self"/>
  <link href="http://indyrb.github.io/"/>
  <updated>2018-04-19T12:59:25-04:00</updated>
  <id>http://indyrb.github.io/</id>
  <author>
    <name><![CDATA[The Indianapolis Ruby Brigade]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Meetup April 11th, 2018]]></title>
    <link href="http://indyrb.github.io/posts/2018/04/11/meetup-april11/"/>
    <updated>2018-04-11T22:00:00-04:00</updated>
    <id>http://indyrb.github.io/posts/2018/04/11/meetup-april11</id>
    <content type="html"><![CDATA[<h3>Ben Cochran - Pry - A Ruby Developer&rsquo;s Friend</h3>

<iframe width="100%" height="300" src="https://www.youtube.com/embed/96OkAtDaBbg" frameborder="0" allowfullscreen></iframe>


<p>In the Ruby world, Pry is IRB on steroids. In a blazingly short period of time you will learn how to install and invoke it, replace your Rails console with it, use it to debug server issues inline, configure macros and shortcuts, and a couple of other neat tips and tricks.</p>

<p>Ben is a Polyglot Principal Full Stack Developer and Architect with 15 years of experience developing standalone and web based applications in Enterprise, Freelance and Startup environments. His company, enhasa.io, is seeking contract work and potential CTO-for-hire engagements. He also has a penchant for 3D Printing as well as using Kubernetes for orchestration of containerized applications.</p>

<h3><a href="https://www.linkedin.com/in/jamesbvsh/">James Bush</a> - Generating Markdown Docs for Rails Models with James Bush</h3>

<p>James shows off a practical solution to crawl a typical Rails app to generate documentation on models, fields and relationships and output to Markdown.</p>

<p>Video is not available, but here&rsquo;s the code shown in the talk:
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">eager_load!</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;models_to_document = ApplicationRecord.descendants</span>
</span><span class='line'><span class="sr">  .map(&amp;amp;:to_s)</span>
</span><span class='line'><span class="sr">  .uniq</span>
</span><span class='line'><span class="sr">  .select { |m|</span>
</span><span class='line'><span class="sr">    ActiveRecord::Base.connection.table_exists? m.underscore.pluralize</span>
</span><span class='line'><span class="sr">  }</span>
</span><span class='line'><span class="sr">  .map(&amp;amp;:constantize)&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">model_descriptions</span> <span class="o">||=</span> <span class="p">{}</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;models_to_document.each do |model|</span>
</span><span class='line'><span class="sr">  model_referenced_by = models_to_document</span>
</span><span class='line'><span class="sr">    .select { |m| m.column_names.include?(&amp;ldquo;</span><span class="si">#{</span> <span class="n">model</span><span class="o">.</span><span class="n">table_name</span><span class="o">.</span><span class="n">singularize</span> <span class="si">}</span><span class="sr">_id&amp;rdquo;) }</span>
</span><span class='line'><span class="sr">    .map(&amp;amp;:to_s)</span>
</span><span class='line'><span class="sr">    .join(&amp;lsquo;, &amp;rsquo;)&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="n">model_references_to</span> <span class="o">=</span> <span class="n">model</span>
</span><span class='line'>    <span class="o">.</span><span class="n">column_names</span>
</span><span class='line'>    <span class="o">.</span><span class="n">select</span> <span class="p">{</span> <span class="o">|</span><span class="n">cn</span><span class="o">|</span> <span class="n">cn</span> <span class="o">=~</span> <span class="sr">/&lt;em&gt;id/</span> <span class="p">}</span>
</span><span class='line'>    <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">r</span><span class="o">|</span> <span class="n">r</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/&lt;/em</span><span class="o">&gt;</span><span class="nb">id</span><span class="o">/</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;)</span> <span class="p">}</span>
</span><span class='line'>    <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="ss">:camelize</span><span class="p">)</span>
</span><span class='line'>    <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;)</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  model_ancestors = model.ancestors.select { |k| k &amp;lt; ApplicationRecord }&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="n">model_descendants</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">descendants</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  model_heirarchy = (model_ancestors + model_descendants).map(&amp;amp;:to_s)&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="n">model_column_names</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">column_names</span><span class="o">.</span><span class="n">reject</span> <span class="p">{</span> <span class="o">|</span><span class="n">cn</span><span class="o">|</span> <span class="n">cn</span> <span class="o">=~</span> <span class="sr">/\Aid|created_at|updated_at|uuid/</span> <span class="p">}</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  model_description = model_descriptions[model.to_s]&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="nb">puts</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="c1">### #{ model.to_s }&amp;rdquo;</span>
</span><span class='line'>  <span class="nb">puts</span>
</span><span class='line'>  <span class="nb">print</span> <span class="n">obj</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="s2">&quot;</span>
</span><span class='line'><span class="s2">  &quot;</span><span class="c1">#{ model_heirarchy.each { |model_name| puts model_name } }&quot; if model_heirarchy.length &amp;gt; 1</span>
</span><span class='line'>  <span class="nb">puts</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span> <span class="n">model</span><span class="o">.</span><span class="n">to_s</span> <span class="si">}</span><span class="s2"> &amp;lt;- </span><span class="si">#{</span> <span class="n">model_referenced_by</span> <span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">model_referenced_by</span><span class="o">.</span><span class="n">present?</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span> <span class="n">model</span><span class="o">.</span><span class="n">to_s</span> <span class="si">}</span><span class="s2"> -&amp;gt; </span><span class="si">#{</span> <span class="n">model_references_to</span> <span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">model_references</span><span class="p">)</span><span class="n">_to</span><span class="o">.</span><span class="n">present?</span>
</span><span class='line'>  <span class="nb">puts</span>
</span><span class='line'>  <span class="n">model_column_names</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">cn</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">&quot;  |</span><span class="si">#{</span> <span class="n">cn</span> <span class="si">}</span><span class="s2">&quot;</span> <span class="p">}</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;&lt;/code&gt;&amp;rdquo;</span>
</span><span class='line'><span class="s2">  puts</span>
</span><span class='line'><span class="s2">  puts &amp;ldquo;</span><span class="si">#{</span> <span class="n">model</span><span class="o">.</span><span class="n">description</span> <span class="si">}</span><span class="s2">&amp;rdquo;</span>
</span><span class='line'><span class="s2">  puts</span>
</span><span class='line'><span class="s2">end</span>
</span></code></pre></td></tr></table></div></figure></p>

<h2>Output as Markdown (for a few models):</h2>

<h3>User</h3>

<pre><code>User &lt;- Certification, Invitation, Message, Philosophy, Prep, Resource

  |email
  |encrypted_password
  |reset_password_token
  |reset_password_sent_at
  |sign_in_count
  |current_sign_in_at
  |last_sign_in_ip
  |name
  |gender
  |age
  |bio
  |height
  |phone_number
  |avatar_file_name
  |avatar_content_type
  |avatar_file_size
  |coach
</code></pre>

<h3>Contest</h3>

<pre><code>Contest -&gt; Prep

  |title
  |prep_id
  |date
  |url
</code></pre>

<h3>Conversation</h3>

<pre><code>Conversation &lt;- Message
Conversation -&gt; Sender, Recipient

  |sender_id
  |recipient_id
</code></pre>
]]></content>
  </entry>
  
</feed>
